<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title></title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a6-tues-feb-16-case-studies.html"/>
<link rel="next" href="a7-thurs-mar-4-final-project-ideas.html"/>
<script src="book_assets/jquery-2.2.3/jquery.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MATH 4190: Math modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Syllabus</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#instructor-information"><i class="fa fa-check"></i><b>1.1</b> Instructor Information</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-information"><i class="fa fa-check"></i><b>1.2</b> Course Information</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#method-of-evaluation"><i class="fa fa-check"></i><b>1.3</b> Method of Evaluation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#additional-policies"><i class="fa fa-check"></i><b>1.4</b> Additional Policies</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#accommodation-of-students-with-disabilities"><i class="fa fa-check"></i><b>1.4.1</b> Accommodation of students with disabilities</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#academic-misconduct"><i class="fa fa-check"></i><b>1.4.2</b> Academic misconduct</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#equity-and-diversity"><i class="fa fa-check"></i><b>1.4.3</b> Equity and Diversity</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#additional-supports"><i class="fa fa-check"></i><b>1.5</b> Additional Supports</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#tentative-course-schedule"><i class="fa fa-check"></i><b>1.6</b> Tentative course schedule</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a1-tues-jan-12-what-is-a-mathematical-model.html"><a href="a1-tues-jan-12-what-is-a-mathematical-model.html"><i class="fa fa-check"></i><b>2</b> A1. Tues Jan 12: What is a mathematical model?</a><ul>
<li class="chapter" data-level="2.1" data-path="a1-tues-jan-12-what-is-a-mathematical-model.html"><a href="a1-tues-jan-12-what-is-a-mathematical-model.html#questions-a1-1"><i class="fa fa-check"></i><b>2.1</b> Questions A1-1</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="a1-thurs-jan-14-getting-started.html"><a href="a1-thurs-jan-14-getting-started.html"><i class="fa fa-check"></i><b>3</b> A1. Thurs Jan 14: Getting started</a><ul>
<li class="chapter" data-level="3.1" data-path="a1-thurs-jan-14-getting-started.html"><a href="a1-thurs-jan-14-getting-started.html#the-cooling-cup-of-coffee"><i class="fa fa-check"></i><b>3.1</b> The cooling cup of coffee</a></li>
<li class="chapter" data-level="3.2" data-path="a1-thurs-jan-14-getting-started.html"><a href="a1-thurs-jan-14-getting-started.html#questions-a1-2"><i class="fa fa-check"></i><b>3.2</b> Questions A1-2</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="a2-tues-jan-19-deriving-ordinary-differential-equation-models.html"><a href="a2-tues-jan-19-deriving-ordinary-differential-equation-models.html"><i class="fa fa-check"></i><b>4</b> A2. Tues Jan 19: Deriving ordinary differential equation models</a><ul>
<li class="chapter" data-level="4.1" data-path="a2-tues-jan-19-deriving-ordinary-differential-equation-models.html"><a href="a2-tues-jan-19-deriving-ordinary-differential-equation-models.html#questions-a2-1"><i class="fa fa-check"></i><b>4.1</b> Questions A2-1</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="a2-thurs-jan-21-deriving-recursion-equation-models.html"><a href="a2-thurs-jan-21-deriving-recursion-equation-models.html"><i class="fa fa-check"></i><b>5</b> A2. Thurs Jan 21: Deriving recursion equation models</a><ul>
<li class="chapter" data-level="5.1" data-path="a2-thurs-jan-21-deriving-recursion-equation-models.html"><a href="a2-thurs-jan-21-deriving-recursion-equation-models.html#questions-a2-2"><i class="fa fa-check"></i><b>5.1</b> Questions A2-2</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="a3-tues-jan-26-analysis-of-dynamical-systems.html"><a href="a3-tues-jan-26-analysis-of-dynamical-systems.html"><i class="fa fa-check"></i><b>6</b> A3. Tues Jan 26: Analysis of dynamical systems</a><ul>
<li class="chapter" data-level="6.1" data-path="a3-tues-jan-26-analysis-of-dynamical-systems.html"><a href="a3-tues-jan-26-analysis-of-dynamical-systems.html#questions-a3-1"><i class="fa fa-check"></i><b>6.1</b> Questions A3-1</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="a3-thurs-jan-28-classic-models-of-population-biology.html"><a href="a3-thurs-jan-28-classic-models-of-population-biology.html"><i class="fa fa-check"></i><b>7</b> A3. Thurs Jan 28: Classic models of population biology</a><ul>
<li class="chapter" data-level="7.1" data-path="a3-thurs-jan-28-classic-models-of-population-biology.html"><a href="a3-thurs-jan-28-classic-models-of-population-biology.html#questions-a3-2"><i class="fa fa-check"></i><b>7.1</b> Questions A3-2</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="a4-tues-feb-2-epidemic-consumer-resource-and-competition-models.html"><a href="a4-tues-feb-2-epidemic-consumer-resource-and-competition-models.html"><i class="fa fa-check"></i><b>8</b> A4. Tues Feb 2: Epidemic, consumer-resource, and competition models</a><ul>
<li class="chapter" data-level="8.1" data-path="a4-tues-feb-2-epidemic-consumer-resource-and-competition-models.html"><a href="a4-tues-feb-2-epidemic-consumer-resource-and-competition-models.html#questions-a4-1"><i class="fa fa-check"></i><b>8.1</b> Questions A4-1</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="a4-thurs-feb-4-check-in.html"><a href="a4-thurs-feb-4-check-in.html"><i class="fa fa-check"></i><b>9</b> A4. Thurs Feb 4: Check-in</a><ul>
<li class="chapter" data-level="9.1" data-path="a4-thurs-feb-4-check-in.html"><a href="a4-thurs-feb-4-check-in.html#questions-a4-2"><i class="fa fa-check"></i><b>9.1</b> Questions A4-2</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="a5-tues-feb-9-numerical-solutions-1.html"><a href="a5-tues-feb-9-numerical-solutions-1.html"><i class="fa fa-check"></i><b>10</b> A5. Tues Feb 9: Numerical solutions - 1</a><ul>
<li class="chapter" data-level="10.1" data-path="a5-tues-feb-9-numerical-solutions-1.html"><a href="a5-tues-feb-9-numerical-solutions-1.html#the-example-model"><i class="fa fa-check"></i><b>10.1</b> The Example model</a></li>
<li class="chapter" data-level="10.2" data-path="a5-tues-feb-9-numerical-solutions-1.html"><a href="a5-tues-feb-9-numerical-solutions-1.html#question-a5-1"><i class="fa fa-check"></i><b>10.2</b> Question A5-1</a></li>
<li class="chapter" data-level="10.3" data-path="a5-tues-feb-9-numerical-solutions-1.html"><a href="a5-tues-feb-9-numerical-solutions-1.html#python"><i class="fa fa-check"></i><b>10.3</b> Python</a></li>
<li class="chapter" data-level="10.4" data-path="a5-tues-feb-9-numerical-solutions-1.html"><a href="a5-tues-feb-9-numerical-solutions-1.html#r"><i class="fa fa-check"></i><b>10.4</b> R</a></li>
<li class="chapter" data-level="10.5" data-path="a5-tues-feb-9-numerical-solutions-1.html"><a href="a5-tues-feb-9-numerical-solutions-1.html#matlab"><i class="fa fa-check"></i><b>10.5</b> MATLAB</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="a5-thurs-feb-11-numerical-solutions-2.html"><a href="a5-thurs-feb-11-numerical-solutions-2.html"><i class="fa fa-check"></i><b>11</b> A5. Thurs Feb 11: Numerical solutions - 2</a><ul>
<li class="chapter" data-level="11.1" data-path="a5-thurs-feb-11-numerical-solutions-2.html"><a href="a5-thurs-feb-11-numerical-solutions-2.html#questions-a5-2"><i class="fa fa-check"></i><b>11.1</b> Questions A5-2</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="a6-tues-feb-16-case-studies.html"><a href="a6-tues-feb-16-case-studies.html"><i class="fa fa-check"></i><b>12</b> A6. Tues Feb 16: Case studies</a><ul>
<li class="chapter" data-level="" data-path="a6-tues-feb-16-case-studies.html"><a href="a6-tues-feb-16-case-studies.html#questions-a6-1"><i class="fa fa-check"></i>Questions A6-1</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="a7-tues-mar-2-parameter-estimation.html"><a href="a7-tues-mar-2-parameter-estimation.html"><i class="fa fa-check"></i><b>13</b> A7. Tues Mar 2: Parameter estimation</a><ul>
<li class="chapter" data-level="13.1" data-path="a7-tues-mar-2-parameter-estimation.html"><a href="a7-tues-mar-2-parameter-estimation.html#parameterizing-exponentially-distributed-rates"><i class="fa fa-check"></i><b>13.1</b> Parameterizing exponentially distributed rates</a></li>
<li class="chapter" data-level="13.2" data-path="a7-tues-mar-2-parameter-estimation.html"><a href="a7-tues-mar-2-parameter-estimation.html#estimating-parameters-through-model-fitting"><i class="fa fa-check"></i><b>13.2</b> Estimating parameters through model fitting</a></li>
<li class="chapter" data-level="" data-path="a6-tues-feb-16-case-studies.html"><a href="a6-tues-feb-16-case-studies.html#questions-a6-1"><i class="fa fa-check"></i>Questions A6-1</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="a7-thurs-mar-4-final-project-ideas.html"><a href="a7-thurs-mar-4-final-project-ideas.html"><i class="fa fa-check"></i><b>14</b> A7. Thurs Mar 4: Final project ideas</a></li>
<li class="chapter" data-level="15" data-path="final-project.html"><a href="final-project.html"><i class="fa fa-check"></i><b>15</b> Final project</a><ul>
<li class="chapter" data-level="15.1" data-path="final-project.html"><a href="final-project.html#written-report"><i class="fa fa-check"></i><b>15.1</b> Written Report</a><ul>
<li class="chapter" data-level="15.1.1" data-path="final-project.html"><a href="final-project.html#introduction"><i class="fa fa-check"></i><b>15.1.1</b> Introduction</a></li>
<li class="chapter" data-level="15.1.2" data-path="final-project.html"><a href="final-project.html#model"><i class="fa fa-check"></i><b>15.1.2</b> Model</a></li>
<li class="chapter" data-level="15.1.3" data-path="final-project.html"><a href="final-project.html#results"><i class="fa fa-check"></i><b>15.1.3</b> Results</a></li>
<li class="chapter" data-level="15.1.4" data-path="final-project.html"><a href="final-project.html#discussion"><i class="fa fa-check"></i><b>15.1.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="final-project.html"><a href="final-project.html#oral-report"><i class="fa fa-check"></i><b>15.2</b> Oral report</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a7.-tues-mar-2-parameter-estimation" class="section level1">
<h1><span class="header-section-number">13</span> A7. Tues Mar 2: Parameter estimation</h1>
<p>Assignment 7: to be handed in to Brightspace on Tues Mar 9 by 2pm.</p>
<div id="parameterizing-exponentially-distributed-rates" class="section level2">
<h2><span class="header-section-number">13.1</span> Parameterizing exponentially distributed rates</h2>
<p>For ordinary differential equation models, frequently the model formulation implies that events happen to the individuals in the population following an exponential distribution.</p>
<p>Consider the rate of recovery for individuals that are infected in an SIR model. The equation for the rate of change in the number of infected individuals, <span class="math inline">\(I(t)\)</span>, is:</p>
<span class="math display">\[\begin{equation}
\frac{dI(t)}{dt} = \beta S(t) I(t) - (v+\gamma)I(t) 
\end{equation}\]</span>
<p>where <span class="math inline">\(\beta\)</span> is the transmission coefficient, <span class="math inline">\(S(t)\)</span> is the number of individuals susceptible to the disease, <span class="math inline">\(v\)</span> is the disease-induced mortality rate and <span class="math inline">\(\gamma\)</span> is the recovery rate. If we consider only a cohort of individuals that are already infected, and will recover, <span class="math inline">\(C(t)\)</span>, then in keeping with the model above, our model for the fraction of individuals in the cohort that have not yet recovered is:</p>
<span class="math display">\[\begin{equation}
\frac{dC(t)}{dt} = - \gamma C(t), 
\end{equation}\]</span>
<p>with <span class="math inline">\(C(0) = 1\)</span> and where <span class="math inline">\(\gamma\)</span> is the same parameter that appears in the <span class="math inline">\(\frac{dI(t)}{dt}\)</span> equation. We can solve the <span class="math inline">\(\frac{dC(t)}{dt}\)</span> equation to find that the ordinary differential equation formulation of the SIR model implies that the fraction of individuals that have recovered by any time, <span class="math inline">\(t\)</span>, is,</p>
<span class="math display">\[\begin{equation}
C(t) = \exp(-\gamma t). 
\end{equation}\]</span>
<p>Note that <span class="math inline">\(1-C(t)\)</span> is the cumulative fraction of the cohort that have recovered at time, <span class="math inline">\(t\)</span>. The probability, <span class="math inline">\(c(t)\)</span>, that an individual in the cohort recovers during the time interval <span class="math inline">\([t, t+\Delta t]\)</span> is the probability density corresponding to <span class="math inline">\(C(t)\)</span>, which is,</p>
<span class="math display">\[\begin{equation}
c(t) = \gamma \exp(-\gamma t). 
\end{equation}\]</span>
<p>Note that for an exponentially distributed random variable, where <span class="math inline">\(\lambda\)</span> is the rate at which the exponential process occurs, the mean time until the event happens is <span class="math inline">\(1/ \lambda\)</span> (i.e., see <a href="https://en.wikipedia.org/wiki/Exponential_distribution">Wikipedia</a>). As such, the mean time to recovery, implied by our SIR model, is <span class="math inline">\(1/ \gamma\)</span>, and so if we can read about our disease of interest and find the mean time to recovery (i.e. <a href="https://www.webmd.com/cold-and-flu/stay-home-cold-flu">WebMD*</a> states that the flu usually lasts 5 days and a cold 7-10 days), then we can simply parameterize the recovery rates as the inverses (i.e., <span class="math inline">\(\gamma\)</span> = 1/5 for the flu and <span class="math inline">\(\gamma \in [\frac{1}{10}, \frac{1}{7}]\)</span> for a cold). Note that the mean time until the event happens would have units of days, which is reassuring since <span class="math inline">\(\gamma\)</span> was a rate and would have units 1/days.</p>
<p>*please use non-peer reviewed websites such as WebMD only as a last resort for you final project; for you final project I would perfer citations to the published literature.</p>
<p>Note that while this example was for an epidemiological model, if you were modelling the rate that customers leave a store, and your model formulation was similar, you could parameterize the leaving rate as the reciporcal of the average time spent in the store.</p>
</div>
<div id="estimating-parameters-through-model-fitting" class="section level2">
<h2><span class="header-section-number">13.2</span> Estimating parameters through model fitting</h2>
<p>Some parameters, such as the transmission coefficient, <span class="math inline">\(\beta\)</span>, for an SIR model, are notoriously difficult to estimate from independent data sources. We can also estimate parameters by fitting to data, particularly when most other parameters can be estimated from independent sources. Consider, the COVID-19 outbreak in St. John's in March 2020. We can fit an SIR model to these data. Let the change in the number of actively infected individuals, <span class="math inline">\(I(t)\)</span>, be,</p>
<span class="math display">\[\begin{eqnarray}
\frac{dS(t){dt} &amp;=&amp; - \beta I(t)\frac{S(t)}{N} \\
\frac{dI(t)}{dt} &amp;=&amp; \beta I(t)\frac{S(t)}{N} - \gamma I(t),
\end{eqnarray}\]</span>
<p>where <span class="math inline">\(\gamma\)</span> is the recovery rate and Newfoundland and Labrador typically declares a recovery 14 days after infection such that <span class="math inline">\(\gamma = 1/14\)</span> days<span class="math inline">\(^{-1}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(deSolve)</code></pre></div>
<pre><code>## Loading required package: deSolve</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">active.cases &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">24</span>,<span class="dv">35</span>,<span class="dv">67</span>,<span class="dv">82</span>,<span class="dv">101</span>,<span class="dv">116</span>,<span class="dv">131</span>,<span class="dv">140</span>,<span class="dv">144</span>,<span class="dv">164</span>,<span class="dv">172</span>,<span class="dv">183</span>,<span class="dv">184</span>,<span class="dv">188</span>,<span class="dv">192</span>,<span class="dv">177</span>,<span class="dv">156</span>,<span class="dv">138</span>,<span class="dv">133</span>,<span class="dv">118</span>,<span class="dv">110</span>,<span class="dv">108</span>,<span class="dv">92</span>, <span class="dv">85</span>, <span class="dv">79</span>, <span class="dv">77</span>, <span class="dv">64</span>, <span class="dv">62</span>, <span class="dv">62</span>, <span class="dv">59</span>, <span class="dv">54</span>, <span class="dv">48</span>, <span class="dv">46</span>, <span class="dv">46</span>, <span class="dv">36</span>, <span class="dv">34</span>, <span class="dv">33</span>, <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">26</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">23</span>, <span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">13</span>, <span class="dv">13</span>, <span class="dv">13</span>, <span class="dv">13</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>)
times &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="kw">length</span>(active.cases))
t.hat &lt;-<span class="st"> </span>times[<span class="kw">which</span>(active.cases ==<span class="st"> </span><span class="kw">max</span>(active.cases))]

N &lt;-<span class="st"> </span><span class="dv">500000</span>
I0 &lt;-<span class="st"> </span>active.cases[<span class="dv">1</span>]
beta1 &lt;-<span class="st"> </span><span class="fl">0.2</span>
beta2 &lt;-<span class="st"> </span><span class="fl">0.01</span>
gamma &lt;-<span class="st"> </span><span class="dv">1</span>/<span class="dv">14</span>

  beta.fun =<span class="st"> </span>function(t){
    if(t&lt;=t.hat){
      betaval &lt;-<span class="st"> </span>beta1
    }
    else {
    betaval &lt;-<span class="st"> </span>beta2
    }

    <span class="kw">return</span>(betaval)
  }

  <span class="co"># Define the system of coupled ODEs for the Miller et al. model</span>
  SIR =<span class="st"> </span>function(t,y,parms){
    S &lt;-<span class="st"> </span>y[<span class="dv">1</span>]
    I &lt;-<span class="st"> </span>y[<span class="dv">2</span>]

    dS =<span class="st"> </span>-<span class="kw">beta.fun</span>(t)*I*S
    dI =<span class="st"> </span><span class="kw">beta.fun</span>(t)*I*S -<span class="st"> </span>gamma*I

    <span class="kw">return</span>(<span class="kw">list</span>(<span class="kw">c</span>(dS,dI)))
  }

 <span class="co"># SIR model</span>
  yini  =<span class="st"> </span><span class="kw">c</span>(<span class="dt">S =</span> <span class="dv">1</span>-I0/N, <span class="dt">I =</span> I0/N)
  out &lt;-<span class="st"> </span><span class="kw">ode</span>(<span class="dt">y =</span> yini, <span class="dt">parms =</span> <span class="ot">NULL</span>, <span class="dt">times =</span> times, <span class="dt">func =</span> SIR)
  out &lt;-<span class="st"> </span><span class="kw">data.frame</span>(out)

<span class="kw">plot</span>(times, active.cases, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">ylab =</span> <span class="st">&quot;active cases&quot;</span>)
<span class="kw">lines</span>(times, out$I*N, <span class="dt">typ =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="math-4190_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="questions-a6-1" class="section level2 unnumbered">
<h2>Questions A6-1</h2>
<ol style="list-style-type: decimal">
<li>Read all the text above. Revisit <a href="https://www-nature-com.qe2a-proxy.mun.ca/articles/s41591-020-0952-y">Disease and healthcare burden of COVID-19 in the United States</a>. For the system of ordinary differential equations that appear in the methods section at the end of the paper choose 2 parameters. Spend 30 minutes following the citations to find the source for how the parameters were estimated. Write 1 paragraph describing if you were able to find a sentence or figure that underpins the estimates of 2 parameters that you chose.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a6-tues-feb-16-case-studies.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="a7-thurs-mar-4-final-project-ideas.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/12-feb-18.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["math-4190.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
