<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title></title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a4-thurs-feb-4-check-in.html"/>
<link rel="next" href="a5-thurs-feb-11-numerical-solutions-2.html"/>
<script src="book_assets/jquery-2.2.3/jquery.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MATH 4190: Math modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Syllabus</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#instructor-information"><i class="fa fa-check"></i><b>1.1</b> Instructor Information</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-information"><i class="fa fa-check"></i><b>1.2</b> Course Information</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#method-of-evaluation"><i class="fa fa-check"></i><b>1.3</b> Method of Evaluation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#additional-policies"><i class="fa fa-check"></i><b>1.4</b> Additional Policies</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#accommodation-of-students-with-disabilities"><i class="fa fa-check"></i><b>1.4.1</b> Accommodation of students with disabilities</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#academic-misconduct"><i class="fa fa-check"></i><b>1.4.2</b> Academic misconduct</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#equity-and-diversity"><i class="fa fa-check"></i><b>1.4.3</b> Equity and Diversity</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#additional-supports"><i class="fa fa-check"></i><b>1.5</b> Additional Supports</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#tentative-course-schedule"><i class="fa fa-check"></i><b>1.6</b> Tentative course schedule</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a1-tues-jan-12-what-is-a-mathematical-model.html"><a href="a1-tues-jan-12-what-is-a-mathematical-model.html"><i class="fa fa-check"></i><b>2</b> A1. Tues Jan 12: What is a mathematical model?</a><ul>
<li class="chapter" data-level="2.1" data-path="a1-tues-jan-12-what-is-a-mathematical-model.html"><a href="a1-tues-jan-12-what-is-a-mathematical-model.html#questions-a1-1"><i class="fa fa-check"></i><b>2.1</b> Questions A1-1</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="a1-thurs-jan-14-getting-started.html"><a href="a1-thurs-jan-14-getting-started.html"><i class="fa fa-check"></i><b>3</b> A1. Thurs Jan 14: Getting started</a><ul>
<li class="chapter" data-level="3.1" data-path="a1-thurs-jan-14-getting-started.html"><a href="a1-thurs-jan-14-getting-started.html#the-cooling-cup-of-coffee"><i class="fa fa-check"></i><b>3.1</b> The cooling cup of coffee</a></li>
<li class="chapter" data-level="3.2" data-path="a1-thurs-jan-14-getting-started.html"><a href="a1-thurs-jan-14-getting-started.html#questions-a1-2"><i class="fa fa-check"></i><b>3.2</b> Questions A1-2</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="a2-tues-jan-19-deriving-ordinary-differential-equation-models.html"><a href="a2-tues-jan-19-deriving-ordinary-differential-equation-models.html"><i class="fa fa-check"></i><b>4</b> A2. Tues Jan 19: Deriving ordinary differential equation models</a><ul>
<li class="chapter" data-level="4.1" data-path="a2-tues-jan-19-deriving-ordinary-differential-equation-models.html"><a href="a2-tues-jan-19-deriving-ordinary-differential-equation-models.html#questions-a2-1"><i class="fa fa-check"></i><b>4.1</b> Questions A2-1</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="a2-thurs-jan-21-deriving-recursion-equation-models.html"><a href="a2-thurs-jan-21-deriving-recursion-equation-models.html"><i class="fa fa-check"></i><b>5</b> A2. Thurs Jan 21: Deriving recursion equation models</a><ul>
<li class="chapter" data-level="5.1" data-path="a2-thurs-jan-21-deriving-recursion-equation-models.html"><a href="a2-thurs-jan-21-deriving-recursion-equation-models.html#questions-a2-2"><i class="fa fa-check"></i><b>5.1</b> Questions A2-2</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="a3-tues-jan-26-analysis-of-dynamical-systems.html"><a href="a3-tues-jan-26-analysis-of-dynamical-systems.html"><i class="fa fa-check"></i><b>6</b> A3. Tues Jan 26: Analysis of dynamical systems</a><ul>
<li class="chapter" data-level="6.1" data-path="a3-tues-jan-26-analysis-of-dynamical-systems.html"><a href="a3-tues-jan-26-analysis-of-dynamical-systems.html#questions-a3-1"><i class="fa fa-check"></i><b>6.1</b> Questions A3-1</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="a3-thurs-jan-28-classic-models-of-population-biology.html"><a href="a3-thurs-jan-28-classic-models-of-population-biology.html"><i class="fa fa-check"></i><b>7</b> A3. Thurs Jan 28: Classic models of population biology</a><ul>
<li class="chapter" data-level="7.1" data-path="a3-thurs-jan-28-classic-models-of-population-biology.html"><a href="a3-thurs-jan-28-classic-models-of-population-biology.html#questions-a3-2"><i class="fa fa-check"></i><b>7.1</b> Questions A3-2</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="a4-tues-feb-2-epidemic-consumer-resource-and-competition-models.html"><a href="a4-tues-feb-2-epidemic-consumer-resource-and-competition-models.html"><i class="fa fa-check"></i><b>8</b> A4. Tues Feb 2: Epidemic, consumer-resource, and competition models</a><ul>
<li class="chapter" data-level="8.1" data-path="a4-tues-feb-2-epidemic-consumer-resource-and-competition-models.html"><a href="a4-tues-feb-2-epidemic-consumer-resource-and-competition-models.html#questions-a4-1"><i class="fa fa-check"></i><b>8.1</b> Questions A4-1</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="a4-thurs-feb-4-check-in.html"><a href="a4-thurs-feb-4-check-in.html"><i class="fa fa-check"></i><b>9</b> A4. Thurs Feb 4: Check-in</a><ul>
<li class="chapter" data-level="9.1" data-path="a4-thurs-feb-4-check-in.html"><a href="a4-thurs-feb-4-check-in.html#questions-a4-2"><i class="fa fa-check"></i><b>9.1</b> Questions A4-2</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="a5-tues-feb-9-numerical-solutions-1.html"><a href="a5-tues-feb-9-numerical-solutions-1.html"><i class="fa fa-check"></i><b>10</b> A5. Tues Feb 9: Numerical solutions - 1</a><ul>
<li class="chapter" data-level="10.1" data-path="a5-tues-feb-9-numerical-solutions-1.html"><a href="a5-tues-feb-9-numerical-solutions-1.html#the-example-model"><i class="fa fa-check"></i><b>10.1</b> The Example model</a></li>
<li class="chapter" data-level="10.2" data-path="a5-tues-feb-9-numerical-solutions-1.html"><a href="a5-tues-feb-9-numerical-solutions-1.html#question-a5-1"><i class="fa fa-check"></i><b>10.2</b> Question A5-1</a></li>
<li class="chapter" data-level="10.3" data-path="a5-tues-feb-9-numerical-solutions-1.html"><a href="a5-tues-feb-9-numerical-solutions-1.html#python"><i class="fa fa-check"></i><b>10.3</b> Python</a></li>
<li class="chapter" data-level="10.4" data-path="a5-tues-feb-9-numerical-solutions-1.html"><a href="a5-tues-feb-9-numerical-solutions-1.html#r"><i class="fa fa-check"></i><b>10.4</b> R</a></li>
<li class="chapter" data-level="10.5" data-path="a5-tues-feb-9-numerical-solutions-1.html"><a href="a5-tues-feb-9-numerical-solutions-1.html#matlab"><i class="fa fa-check"></i><b>10.5</b> MATLAB</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="a5-thurs-feb-11-numerical-solutions-2.html"><a href="a5-thurs-feb-11-numerical-solutions-2.html"><i class="fa fa-check"></i><b>11</b> A5. Thurs Feb 11: Numerical solutions - 2</a><ul>
<li class="chapter" data-level="11.1" data-path="a5-thurs-feb-11-numerical-solutions-2.html"><a href="a5-thurs-feb-11-numerical-solutions-2.html#questions-a5-2"><i class="fa fa-check"></i><b>11.1</b> Questions A5-2</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="a6-tues-feb-16-case-studies.html"><a href="a6-tues-feb-16-case-studies.html"><i class="fa fa-check"></i><b>12</b> A6. Tues Feb 16: Case studies</a><ul>
<li class="chapter" data-level="" data-path="a6-tues-feb-16-case-studies.html"><a href="a6-tues-feb-16-case-studies.html#questions-a6-1"><i class="fa fa-check"></i>Questions A6-1</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="a7-tues-mar-2-parameter-estimation.html"><a href="a7-tues-mar-2-parameter-estimation.html"><i class="fa fa-check"></i><b>13</b> A7. Tues Mar 2: Parameter estimation</a><ul>
<li class="chapter" data-level="13.1" data-path="a7-tues-mar-2-parameter-estimation.html"><a href="a7-tues-mar-2-parameter-estimation.html#parameterizing-exponentially-distributed-rates"><i class="fa fa-check"></i><b>13.1</b> Parameterizing exponentially distributed rates</a></li>
<li class="chapter" data-level="13.2" data-path="a7-tues-mar-2-parameter-estimation.html"><a href="a7-tues-mar-2-parameter-estimation.html#estimating-parameters-through-model-fitting"><i class="fa fa-check"></i><b>13.2</b> Estimating parameters through model fitting</a></li>
<li class="chapter" data-level="" data-path="a7-tues-mar-2-parameter-estimation.html"><a href="a7-tues-mar-2-parameter-estimation.html#questions-a7-1"><i class="fa fa-check"></i>Questions A7-1</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="a7-thurs-mar-4-final-project-ideas.html"><a href="a7-thurs-mar-4-final-project-ideas.html"><i class="fa fa-check"></i><b>14</b> A7. Thurs Mar 4: Final project ideas</a><ul>
<li class="chapter" data-level="" data-path="a7-thurs-mar-4-final-project-ideas.html"><a href="a7-thurs-mar-4-final-project-ideas.html#questions-a7-2"><i class="fa fa-check"></i>Questions A7-2</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="final-project.html"><a href="final-project.html"><i class="fa fa-check"></i><b>15</b> Final project</a><ul>
<li class="chapter" data-level="15.1" data-path="final-project.html"><a href="final-project.html#written-report"><i class="fa fa-check"></i><b>15.1</b> Written Report</a><ul>
<li class="chapter" data-level="15.1.1" data-path="final-project.html"><a href="final-project.html#introduction"><i class="fa fa-check"></i><b>15.1.1</b> Introduction</a></li>
<li class="chapter" data-level="15.1.2" data-path="final-project.html"><a href="final-project.html#model"><i class="fa fa-check"></i><b>15.1.2</b> Model</a></li>
<li class="chapter" data-level="15.1.3" data-path="final-project.html"><a href="final-project.html#results"><i class="fa fa-check"></i><b>15.1.3</b> Results</a></li>
<li class="chapter" data-level="15.1.4" data-path="final-project.html"><a href="final-project.html#discussion"><i class="fa fa-check"></i><b>15.1.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="final-project.html"><a href="final-project.html#oral-report"><i class="fa fa-check"></i><b>15.2</b> Oral report</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a5.-tues-feb-9-numerical-solutions---1" class="section level1">
<h1><span class="header-section-number">10</span> A5. Tues Feb 9: Numerical solutions - 1</h1>
<p>Assignment 5: to be handed in to Brightspace on Thurs Feb 18 by 2pm.</p>
<hr />
<p>For many nonlinear ordinary differential equations (ODEs), it is not possible to find expressions for the values of the dependent variables for any time. We can, however, solve the ODEs using numerical methods. Regarding specific programming languages, I will provide the following support:</p>
<p><em>Python</em> Example codes that solve ODEs and nonlinear recursion equations;</p>
<p><em>R</em> and <em>MATLAB</em> in addition to the above, I can provide some additional support debugging your code;</p>
<p>You may choose to work in another programming language that you are an expert in, however, you may need to complete your codes unaided.</p>
<div id="the-example-model" class="section level2">
<h2><span class="header-section-number">10.1</span> The Example model</h2>
<p>In the example codes, the model that is solved is:</p>
<span class="math display">\[\begin{eqnarray}
\frac{dS(t)}{dt} &amp; = &amp; - \beta I(t)\frac{S(t)}{N},\\
\frac{dI(t)}{dt} &amp; = &amp; \beta I(t)\frac{S(t)}{N} - \gamma I(t),
\end{eqnarray}\]</span>
<p>with <span class="math inline">\(S(0) = 1 - 10^{-4}\)</span> and <span class="math inline">\(I(0) = 10^{-4}\)</span> and for <span class="math inline">\(0 \leq t \leq 365\)</span> days. You may recognize these equations as a Susceptible-Infected-Recovered epidemiological model. The average number of secondary infections produced per infected individual over their entire infectious period, when <span class="math inline">\(S/N \approx 1\)</span> is <span class="math inline">\(R_0 = \beta/\gamma\)</span>. Note that for <span class="math inline">\(R_0 &gt; 1\)</span>, the number of infections will grow, i.e., <span class="math inline">\(I(t)\)</span> is initially an increasing function for <span class="math inline">\(t&gt;0\)</span>, and visa versa for <span class="math inline">\(R_0 &lt; 1\)</span>, and this property is a <em>unit test</em> that we can use to verify that our code is working correctly (i.e., run the code with <span class="math inline">\(R_0 &gt; 1\)</span> and <span class="math inline">\(R_0 &lt; 1\)</span> and check that the solutions are <span class="math inline">\(I(t)\)</span> are as expected).</p>
</div>
<div id="question-a5-1" class="section level2">
<h2><span class="header-section-number">10.2</span> Question A5-1</h2>
<ol style="list-style-type: decimal">
<li>On brightspace, you are to hand-in: (i) your code that solves the example model. This is completed by cutting and pasting the code blocks below [10 marks]; and (ii) the .png figures your code makes for <span class="math inline">\(R_0 &gt; 1\)</span> and <span class="math inline">\(R_0 &lt; 1\)</span> [5 marks].</li>
</ol>
</div>
<div id="python" class="section level2">
<h2><span class="header-section-number">10.3</span> Python</h2>
<p>Make sure you have Python installed. On my <em>MacBook Air</em>, I then open a terminal window and type <code>jupyter notebook</code>. A browser window will open, and allow me to open a <code>.py</code> file or begin a new file <code>.py</code>. To execute a code block, I press <code>Shift + Enter</code>.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># Import the packages with the functions required to numerically solve ODEs</span>
<span class="im">from</span> numpy <span class="im">import</span> <span class="op">*</span>
<span class="im">import</span> pylab <span class="im">as</span> p
<span class="im">from</span> scipy <span class="im">import</span> integrate</code></pre></div>
<p>Copy the above code block into your juypter notebook and press <code>Shift + Enter</code>.</p>
<p>The code block below defines the parameter values, initial conditions, range of the independent variable to solve over, and the system of ODEs that you wish to solve.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># Parameters</span>
gamma <span class="op">=</span> <span class="dv">1</span><span class="op">/</span><span class="dv">8</span> <span class="co"># 1/(duration of infectivity)</span>
R0 <span class="op">=</span> <span class="dv">2</span> <span class="co"># (av. number of secondary infections per infected)</span>
N <span class="op">=</span> <span class="dv">1</span> <span class="co"># (total population size = 1; dependant variables are fractions)</span>
I0 <span class="op">=</span> <span class="fl">1e-4</span> <span class="co"># (initial proportion infected)</span>

<span class="co"># Note: the transmission rate is beta = R0*gamma, i.e., the number</span>
<span class="co"># infections per infected per day, multiplied by 1/gamma (the average</span>
<span class="co"># duration of infectivity)</span>
beta <span class="op">=</span> R0<span class="op">*</span>gamma

<span class="co"># t is a vector of the values of the independent variable, t, for which</span>
<span class="co"># we would like the dependent variables, S(t) and I(t).</span>
t <span class="op">=</span> linspace(<span class="dv">0</span>, <span class="dv">365</span>, <span class="dv">1000</span>) 
X0 <span class="op">=</span> array([N<span class="op">-</span>I0, I0]) <span class="co"># initial values S(0) and I(0).</span>

<span class="co"># This is a function returning dS/dt and dI/dt.</span>
<span class="kw">def</span> dX_dt(X, t<span class="op">=</span><span class="dv">0</span>):
    S <span class="op">=</span> X[<span class="dv">0</span>]
    I <span class="op">=</span> X[<span class="dv">1</span>]
    <span class="cf">return</span> array([ <span class="op">-</span> beta<span class="op">*</span>I<span class="op">*</span>S<span class="op">/</span>N ,
                  <span class="op">-</span>gamma<span class="op">*</span>I <span class="op">+</span> beta<span class="op">*</span>I<span class="op">*</span>S<span class="op">/</span>N ])</code></pre></div>
<p>Any code block you enter into your juypter notebook can be executed by pressing <code>Shift + Enter</code>.</p>
<p>The code block below performs the numerical integration:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># integrate.odeint is a function from the packages we uploaded which</span>
<span class="co"># performs the numerical integration of dX_dt for the initial values,</span>
<span class="co"># X0, and over the range of t values, t.</span>
X, infodict <span class="op">=</span> integrate.odeint(dX_dt, X0, t, full_output<span class="op">=</span><span class="va">True</span>)
infodict[<span class="st">&#39;message&#39;</span>] </code></pre></div>
<p>The code block below then plots the model solutions:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># The commands below produce a plot of your dependent variables versus</span>
<span class="co"># time. The plot is exported as &#39;SIR.png&#39; which is saved to your working</span>
<span class="co"># directory.</span>

susceptible, infected <span class="op">=</span> X.T
f1 <span class="op">=</span> p.figure()
p.plot(t, susceptible, <span class="st">&#39;b-&#39;</span>, label<span class="op">=</span><span class="st">&#39;Susceptible&#39;</span>)
p.plot(t, infected  , <span class="st">&#39;r-&#39;</span>, label<span class="op">=</span><span class="st">&#39;Infected&#39;</span>)
p.grid()
p.legend(loc<span class="op">=</span><span class="st">&#39;best&#39;</span>)
p.xlabel(<span class="st">&#39;time&#39;</span>)
p.ylabel(<span class="st">&#39;proportion&#39;</span>)
p.title(<span class="st">&#39;SIR model&#39;</span>)
f1.savefig(<span class="st">&#39;SIR.png&#39;</span>)</code></pre></div>
<p>Cutting and pasting these code blocks and executing the commands will complete the required assignment. You will need to change the value of <span class="math inline">\(R_0\)</span> to make your second graph.</p>
</div>
<div id="r" class="section level2">
<h2><span class="header-section-number">10.4</span> R</h2>
<p>Install <code>R</code> and <code>RStudio</code> <a href="https://ahurford.github.io/quant-guide-all-courses/install.html">Link</a>.</p>
<p>Familiarize yourself with the <code>Console</code> and <code>Source</code> panes <a href="https://ahurford.github.io/quant-guide-all-courses/rstudio.html">Link</a> and Best Practicing for writing code <a href="https://ahurford.github.io/quant-guide-all-courses/style.html">Link</a>.</p>
<p>To solve the Model example, begin by installing the <code>deSolve</code> package. Type the following into the <code>Console</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;deSolve&quot;</span>)</code></pre></div>
<p>The <code>deSolve</code> package includes the function <code>ode()</code>, which we will use to solve the ODE. Begin your script by loading the package (this is different than installing it):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(deSolve)</code></pre></div>
<p>Next define the parameter values, initial conditions, range of time values to solve over, and the ODE:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Parameters</span>
gamma &lt;-<span class="st"> </span><span class="dv">1</span>/<span class="dv">8</span> <span class="co"># 1/(duration of infectivity)</span>
R0 &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co"># (av. number of secondary infections per infected)</span>
N &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># (total population size = 1; dependant variables are fractions)</span>
I0 &lt;-<span class="st"> </span><span class="fl">1e-4</span> <span class="co"># (initial proportion infected)</span>

<span class="co"># Note: the transmission rate is beta = R0*gamma, i.e., the number</span>
<span class="co"># infections per infected per day, multiplied by 1/gamma (the average</span>
<span class="co"># duration of infectivity)</span>
beta &lt;-<span class="st"> </span>R0*gamma

<span class="co"># t is a vector of the values of the independent variable, t, for which</span>
<span class="co"># we would like the dependent variables, S(t) and I(t).</span>
t &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">365</span>, .<span class="dv">1</span>) 
Y0 =<span class="st"> </span><span class="kw">c</span>(<span class="dt">S=</span>N-I0, <span class="dt">I=</span>I0) <span class="co"># initial values S(0) and I(0).</span>

<span class="co"># This is a function returning dS/dt and dI/dt.</span>
dY_dt =<span class="st"> </span>function(t,y,parms){
  <span class="co"># It&#39;s a personal perference of mine to switch the symbols</span>
  <span class="co"># to be consistent with the equation.</span>
  S &lt;-<span class="st"> </span>y[<span class="dv">1</span>]
  I &lt;-<span class="st"> </span>y[<span class="dv">2</span>]
 dS &lt;-<span class="st"> </span>-<span class="st"> </span>beta*I*S/N
 dI &lt;-<span class="st"> </span>-gamma*I +<span class="st"> </span>beta*I*S/N 
  <span class="co"># The function returns the value of the change in S(t) and I(t).</span>
<span class="kw">return</span>(<span class="kw">list</span>(<span class="kw">c</span>(dS,dI)))
}</code></pre></div>
<p>Next use the <code>ode()</code> function to solve the ODE and plot the results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># performing the numerical integration</span>
out &lt;-<span class="st"> </span><span class="kw">ode</span>(<span class="dt">y =</span> Y0, <span class="dt">parms =</span> <span class="ot">NULL</span>, <span class="dt">times =</span> t, <span class="dt">func =</span> dY_dt)
out &lt;-<span class="st"> </span><span class="kw">data.frame</span>(out)
<span class="co"># Make the graph</span>
<span class="kw">plot</span>(out$t, out$S, <span class="dt">typ =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">ylab =</span> <span class="st">&quot;proportion&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;time&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;SIR model&quot;</span>)
<span class="kw">lines</span>(out$t, out$I, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p>For additional guidance see <a href="https://ahurford.github.io/quant-guide-all-courses/graph.html">Making graphs in R</a></p>
</div>
<div id="matlab" class="section level2">
<h2><span class="header-section-number">10.5</span> MATLAB</h2>
<p>Please email Dr. Hurford (<a href="mailto:ahurford@mun.ca">ahurford@mun.ca</a>) if you would like to complete this assignment in MATLAB.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a4-thurs-feb-4-check-in.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="a5-thurs-feb-11-numerical-solutions-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/09-feb-9.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["math-4190.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
